"use client";
import{_ as e}from"@swc/helpers/_/_object_without_properties_loose";import{jsxs as s,jsx as l}from"react/jsx-runtime";import{ChevronDownIcon as r,XMarkIcon as a,ChevronRightIcon as i}from"@heroicons/react/24/outline";import{getValue as o,classNames as n,mergeRefs as t,InputGroup as d,InputField as c,Suffix as m,Button as u,eventHandler as p}from"@rafty/ui";import{cva as h}from"class-variance-authority";import{forwardRef as z,useRef as b,useState as f}from"react";import{useDropdown as y}from"./useDropdown.esm.js";import{useNormalizedItems as v}from"./useNormalizedItems.esm.js";const g=z((function(r,a){var{items:i=[],onValueChange:d,separator:c=" / ",value:m,defaultValue:u,size:h="md",isDisabled:z=!1,isReadOnly:g=!1,className:w}=r,k=e(r,["items","onValueChange","separator","value","defaultValue","size","isDisabled","isReadOnly","className"]);const N=b(null),[D,C]=f(u),V=o(z),j=o(g),{isDropdownVisible:I,toggleDropdownVisible:_}=y(N),{normalizeItem:S,getSelectedItems:$}=v({value:"value",label:"label",children:"children"});let K="";if(D){K=$(i,D).map((({label:e})=>e)).join(c)}return s("div",{className:n("relative w-full cursor-pointer",w),ref:t(a,N),children:[l(x,{name:k.name,size:h,placeholder:k.placeholder,disabled:V,readOnly:j,inputValue:K,selected:D,openMenu:()=>{j||_()},onClear:()=>{null==d||d(void 0,void 0),C(void 0)}}),I&&l(O,{items:i,size:h,onSelect:e=>p((()=>{if(e.disabled)return;const s=$(i,e.value);null==d||d(s.slice(-1)[0].value,s),C(e.value),_(!1)})),normalizeItem:S})]})})),w=h("stroke-secondary-400 dark:stroke-secondary-600 stroke-[3]",{variants:{size:{sm:"size-3",md:"size-3.5",lg:"size-4"}}}),k=h("absolute p-1",{variants:{size:{sm:"size-[18px] p-0.5 right-7 rounded-sm",md:"size-6 p-1 right-8 rounded",lg:"size-[26px] p-1 right-9 rounded"},readOnly:{true:"pointer-events-none cursor-default",false:""}}});function x(e){return s(d,{size:e.size,className:"[&>div]:flex [&>div]:items-center",children:[l(c,{name:e.name,placeholder:e.placeholder,value:e.inputValue,onClick:e.openMenu,onKeyDown:s=>{"Enter"===s.key&&e.openMenu()},disabled:e.disabled,readOnly:!0,className:e.disabled?"cursor-not-allowed":e.readOnly?"cursor-default":"cursor-pointer"}),l(m,{children:l(r,{className:w({size:e.size})})}),e.selected&&l(u,{variant:"ghost",size:"icon",colorScheme:"error",isDisabled:e.disabled,onClick:e.onClear,onKeyDown:s=>{"Enter"===s.key&&e.onClear()},className:k({size:e.size,readOnly:e.readOnly}),children:l(a,{className:"size-full stroke-[3]"})})]})}const N=h("dark:bg-secondary-800 dark:text-white absolute z-50 bg-white",{variants:{size:{sm:"min-w-32 shadow",md:"min-w-36 shadow-md",lg:"min-w-40 shadow-lg"}}}),D=h("flex items-center justify-between gap-1 [&>ul]:left-full [&>ul]:top-0 [&>ul]:hidden [&>ul]:min-h-full [&>ul]:hover:block",{variants:{size:{sm:"text-xs px-2.5 py-2",md:"text-sm px-3.5 py-2.5",lg:"text-base px-[18px] py-3"},disabled:{true:"cursor-not-allowed opacity-60",false:"hover:bg-secondary-100 dark:hover:bg-secondary-700 cursor-pointer"}}}),C=h("stroke-secondary-600 dark:stroke-secondary-400 stroke-[2.5]",{variants:{size:{sm:"size-2.5",md:"size-3",lg:"size-3.5"}}});function O({size:e,items:r,normalizeItem:a,onSelect:o}){const n=r=>l("ul",{className:N({size:e}),children:r.map(((r,t)=>{const{children:d,disabled:c=!1,label:m,value:u}=a(r);return Array.isArray(d)&&d.length>=1?s("li",{className:D({size:e,disabled:c}),children:[m,l(i,{className:C({size:e})}),n(d)]},`${t}-${u}`):l("li",{className:D({size:e,disabled:c}),onClick:o(r),onKeyDown:o(r),children:m},`${t}-${u}`)}))});return n(r)}export{g as Cascader};
